---
title: "Alt-Right Corpus"
output: html_notebook
---

```{r setup, include=FALSE}
library(flexdashboard)
pacman::p_load(tidyverse, dplyr, ggplot2, stringr, scales, lubridate, tidytext, tidyr, ggthemes, Rfacebook)

get_post <- function(id){
  tryCatch({
    post <- getPost(
      id, 
      my_key, 
      n = 1000, 
      likes = T, 
      comments = T, 
      reactions = F
    )[[3]]
  }, error = function(e){
    post <- NA
  })

  cat(id, "\n")
  return(post)
}
```


```{r}
altright_list <- list(
  "milo" = "423006854503882",
  "coulter" = "695526053890545",
  "cernovich" = "427302110732180",
  "alexjones" = "6499393458",
  "PJW" = "242174545810040",
  "lauren" = "184795298567879",
  "roaming" = "1213352768743538",
  "bps" = "359762154043841",
  "blairewhite" = "1136054926414603",
  "disdain" = "1772552276096911",
    "infowars" = "80256732576",
    "abc" = "86680728811",
    "nyt" = "5281959998",
    "djt" = "153080620724",
    "wapo" = "6250307292",
    "cnn" = "5550296508",
    "rebel" = "145634995501895",
    "tommy" = "381971441938916"
)

my_key <- "EAACEdEose0cBAKAGt6AhDYdGl2ByUzHXKJWhWQHfHMsbmiYOGH4gKKWUpj0OFZALQnSVjJ4QNH349QZBAgIfZApSpZBliZCzASIRMRZB1VFSw6ggyAirosyrdoSyDAtZCpMcBtoMMbTiyuIOZALH78McPgbHzxjZBgLZAs8RDWruFW81gunuDj0A8jcmGZCrVIkJwHpR7OOReNfvAZDZD"


data_list <- list()
for (jj in seq_along(altright_list)) {
  
  id <- altright_list[[jj]]
  
  page <- getPage(
    id, 
    my_key, 
    n = 10000, 
    since = '2016/12/07', 
    until = '2017/12/07'
  )
  
  save(page, file = paste0("data/", names(altright_list)[jj], ".Rdata"))
  
  comments <- list()
  for (ii in seq_along(page$id)) {
    comments[[ii]] <- get_post(page$id[ii])
    cat(ii)
  }
  comments <- bind_rows(comments)
  #comments <- page$id %>% 
  #  purrr::map_df(get_post)
  
  save(comments, file = paste0("data/",names(altright_list)[jj], "_comments.Rdata"))
  
  cat(jj, "\n")
  data_list[[jj]] <- comments
}

comments <- bind_rows(data_list)
```

```{r}
for (variable in vector) {
  
}
```

